<!DOCTYPE html>
<html  xmlns:th="http://www.thymeleaf.org">
    <head>
        <title>Detalles Usuario</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    </head>
    <body class="container">
        <div class="container text-center rounded shadow-sm">
            <div class="container text-center">
                <div class="mb-3 row align-items-start">
                    <div class="col" >
                        <h3>Información Usuario</h3>
                        <div class="text-center">
                            <img src="https://static.vecteezy.com/system/resources/thumbnails/022/014/184/small/user-icon-member-login-isolated-vector.jpg" class="rounded" style="max-width: 18rpx;">
                        </div>

                        <tr th:each="usuario : ${usuario}">

                        <div th:if="${Usuario != null}">
                            <p th:text="${Usuario.idUsuario}">User ID</p>
                        </div>
                        <div class="row g-3">
                            <div class="input-group mb-3">

                                <div class="mb-3">

                                    <label for="NombreUsuario" class="form-label fw-bold">Nombre</label>
                                    <input type="text" class="form-control" placeholder="Nombre" id="NombreUsuario" 
                                           th:field="${usuario.Nombre}" onkeypress="SoloLetras(event, this)">  

                                    <span class="text-danger error-msg"></span>
                                </div>

                                <div class="mb-3">
                                    <label for="ApellidoPaterno" class="form-label fw-bold">ApellidoPaterno</label>
                                    <input type="text" class="form-control" placeholder="Apellido Paterno" id="ApellidoPaterno" 
                                           th:field="${usuario.ApellidoPaterno}" onkeypress="SoloLetras(event, this)">             
                                    <span class="text-danger error-msg"></span>
                                </div>

                                <div class="mb-3">
                                    <label for="ApellidoMaterno" class="form-label fw-bold">ApellidoMaterno</label>
                                    <input type="text" class="form-control" placeholder="Apellido Materno" id="ApellidoMaterno" 
                                           th:field="${usuario.ApellidoMaterno}" onkeypress="SoloLetras(event, this)">             
                                    <span class="text-danger error-msg"></span>
                                </div>

                                <div class="mb-3">
                                    <label for="username" class="form-label fw-bold">username</label>
                                    <input type="text" class="form-control" placeholder="username" id="username" 
                                           th:field="${usuario.username}" onkeypress="username(event, this)">             
                                    <span class="text-danger error-msg"></span>
                                </div>


                                <div class="mb-3">
                                    <label for="Correo" class="form-label fw-bold">Correo</label>
                                    <input type="email" class="form-control" placeholder="Correo" id="Correo" 
                                           th:field="${usuario.Email}" oninput="Email(event, this)">             
                                    <span class="text-danger error-msg"></span>
                                </div>


                                <div class="mb-3">
                                    <label for="Telefono" class="form-label fw-bold">Telefono</label>
                                    <input type="text" class="form-control" placeholder="Telefono" id="Telefono" 
                                           th:field="${usuario.Telefono}" oninput="numeroCT(event, this)">             
                                    <span class="text-danger error-msg"></span>
                                </div>

                                <div class="mb-3">
                                    <label for="Celular" class="form-label fw-bold">Celular</label>
                                    <input type="tel" class="form-control" placeholder="Celular" id="Celular" 
                                           th:field="${usuario.Celular}" oninput="numeroCT(event, this)">             
                                    <span class="text-danger error-msg"></span>
                                </div>

                                <div class="mb-3">
                                    <label for="fechanacimiento" class="form-label fw-bold">fechanacimiento</label>
                                    <input type="date" class="form-control" placeholder="fechanacimiento" id="fechanacimiento" 
                                           th:field="${usuario.fechanacimiento}" onblur="Fecha(event, this)">             
                                    <span class="text-danger error-msg"></span>
                                </div>                                                                                               

                                <div class="mb-3">
                                    <label for="Curp" class="form-label fw-bold">Curp</label>
                                    <input type="text" class="form-control" placeholder="Curp" id="Curp" 
                                           th:field="${usuario.Curp}" oninput="Curp(event, this)">             
                                    <span class="text-danger error-msg"></span>
                                </div>

                            

                            <div class="container mb-3 align-items-start" id="sexo" th:field="*{sexo}" for="sexo">
                                <i class="bi bi-person-standing"></i>
                                <input type="radio" class="btn btn-primary" name="sexo" value="H" placeholder="Hombre">
                                <i class="bi bi-person-standing-dress"></i>
                                <input type="radio" class="btn btn-primary" name="sexo" value="M" placeholder="Mujer">
                            </div> 

                            <div class="mb-3">
                                <label for="password" class="form-label fw-bold">password</label>
                                <input type="password" class="form-control" placeholder="password" id="password" 
                                       th:field="${usuario.password}" oninput="password(event, this)">             
                                <span class="text-danger error-msg"></span>
                            </div>

                           
                            </div>
                             <div class="mb-3">
                                <a class="btn btn-primary" th:href="@{/usuario/formEditable?idUsuario=}+${usuario.idUsuario}">Editar Información</a>
                            </div>
                        </div>


                    </div>
                    <div class="col">
                        <h3>Direccion(es)</h3>

                        <!--<img src="https://cdn-icons-png.flaticon.com/512/4226/4226982.png" class="rounded" style="max-width: 10rem;">-->
                        <table class="table">
                            <thead>
                                <tr>

                                    <th scope="col">Calle</th>
                                    <th scope="col">Numero Interior</th>
                                    <th scope="col">Numero Exterior</th>
                                </tr>
                            </thead>
                            <tbody>

                                <tr th:if="${usuario.Direcciones != null}" 
                                    th:each="direccion : ${usuario.Direcciones}">
                                    <td th:text="${direccion.Calle}"></td>
                                    <td th:text="${direccion.NumeroInterior}"</td>
                                    <td th:text="${direccion.NumeroExterior}"></td>
                                    <td>
                                        <a class="btn btn-warning btn-sm" th:href="@{/usuario/formEditable?idUsuario=}+${usuario.idUsuario}+'&IdDireccion='+${direccion.IdDireccion}">Editar</a> 
                                        <a class="btn btn-danger btn-sm">Borrar</a>
                                        <!--                                        <button th:onclick="|EliminarDireccion(${direccion.IdDireccion})|" class="btn btn-danger">
                                                                                    <i class="bi bi-trash-fill"></i>
                                                                                </button>-->
                                    </td>
                                </tr>



                                <tr th:unless="${usuario.Direcciones != null}">
                                    <td colspan="2">Sin dirección.</td>
                                </tr>                            


                            </tbody>

                        </table>

                        <div>
                            <a class="btn btn-secondary mt-2 col-12" th:href="@{/usuario/formEditable?idUsuario=}+${usuario.idUsuario}+'&IdDireccion=0'">Agregar Dirección</a>
                        </div>
                        <div id="idoculto" class=hidden>
                            <input type="hidden" th:field="${usuario.idUsuario}">

                        </div>
                    </div>
                </div>
            </div>
        </div>

    </body>
    <script src="https://code.jquery.com/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
    <!--    <script>
             
            function EliminarDireccion(IdDireccion) {
            console.log("Boton de eliminar direccion");
            Swal.fire({
                title: "¿Estas seguro de eliminar la direccion?",
                        text: "La direccion se va a eliminar",
                        icon: "warning",
                        showCancelButton: true,
                        confirmButtonColor: "#3085d6",
                        cancelButtonColor: "#d33",
                        confirmButtonText: "Si, borrar"
            }).then((result) => {
                if (result.isConfirmed) {
                window.location.href = "/usuario/deleteDireccion/" + IdDireccion;
              }
            });
            }
    
        </script>-->
    <script>

                                               function numeroCT(event, input) {
                                                   let key = event.key;
                                                   let RegExp = /^\d{10}$/;
                                                   if (RegExp.test(input.value)) {
                                                       $(input).removeClass("error").addClass("correct");
                                                       $(input).siblings(".error-msg").text("");
                                                   } else {
                                                       $(input).removeClass("correct").addClass("error");
                                                       $(input).siblings(".error-msg").text("Ingresa un número válido");
                                                   }
                                               }

                                               function Curp(event, input) {
                                                   let value = input.value;
                                                   let RegExp = /^[A-Z]{4}[0-9]{6}[A-Z]{7}[0-9]{1}$/;

                                                   if (RegExp.test(value)) {
                                                       $(input).removeClass("error").addClass("correct");
                                                       $(input).siblings(".error-msg").text("");
                                                   } else {
                                                       $(input).removeClass("correct").addClass("error");
                                                       $(input).siblings(".error-msg").text("Ingresa una curp valida");
                                                   }
                                               }

                                               function SoloLetras(event, input) {
                                                   let key = event.key;
                                                   let RegExp = /[a-zA-Z]+/;
                                                   if (RegExp.test(key)) {
                                                       $(input).removeClass("error").addClass("correct");
                                                       $(input).siblings(".error-msg").text("");
                                                   } else {
                                                       $(input).removeClass("correct").addClass("error");
                                                       $(input).siblings(".error-msg").text("No se permiten numeros");
                                                       event.preventDefault();
                                                   }
                                               }

                                               function Email(event, input) {
                                                   let key = event.key;
                                                   let RegExp = /^[^@]+@[^@]+\.[a-zA-Z]{2,}$/;
                                                   if (RegExp.test(input.value)) {
                                                       $(input).removeClass("error").addClass("correct");
                                                       $(input).siblings(".error-msg").text("");
                                                   } else {
                                                       $(input).removeClass("correct").addClass("error");
                                                       $(input).siblings(".error-msg").text("Ingresa un correo valido");
                                                       event.preventDefault();
                                                   }
                                               }

                                               function Fecha(event, input) {

                                                   const FechaInput = new Date(input.value);
                                                   const FechaActual = new Date();

                                                   if (FechaInput < FechaActual) {
                                                       $(input).removeClass("error").addClass("correct");

                                                   } else {
                                                       $(input).removeClass("correct").addClass("error");
                                                       $(input).siblings(".error-msg").text("Ingresa una fecha valida");
                                                       event.preventDefault();
                                                   }

                                               }

                                               function username(event, input) {
                                                   let key = event.key();

                                                   let RegExp = /\w+/;

                                                   if (RegExp.test(key)) {
                                                       $(input).removeClass("error").addClass("correct");
                                                   } else {
                                                       $(input).removeClass("correct").addClass("error");
                                                       $(input).siblings(".error-msg").text("Ingresa un usuario valido");
                                                       event.preventDefault();
                                                   }

                                               }

                                               function password(event, input) {

                                                   let RegExp = /^(?=\w*\d)(?=\w*[A-Z])(?=\w*[a-z])\S{8,}$/;


                                                   if (RegExp.test(input.value)) {

                                                       $(input).removeClass("error").addClass("correct");
                                                       $(input).siblings(".error-msg").text("");  // Limpiar el mensaje de error
                                                   } else {

                                                       $(input).removeClass("correct").addClass("error");
                                                       $(input).siblings(".error-msg").text("Ingresa una contraseña de mínimo 8 dígitos con al menos una mayúscula y número.");
                                                   }
                                               }

    </script>
</html>





